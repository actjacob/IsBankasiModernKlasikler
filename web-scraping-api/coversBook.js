import axios from "axios";
import fs from "fs";
import path from "path";

// ISBN listesi
const isbnList = [
  9786254298943, 9786254299397, 9786254299502, 9786254299632, 9786257070133, 9786257070140,
  9786257070300, 9786257070423, 9786257070324, 9786257070461, 9786257070782, 9786257070775,
  9786254050008, 9786257070935, 9786254050244, 9786254050657, 9786254050671, 9786254050664,
  9786254051388, 9786254051371, 9786254051807, 9786254052033, 9786254052040, 9786254052781,
  9786254052972, 9786254052996, 9786254053276, 9786254053214, 9786254053641, 9786254053610,
  9786254054525, 9786254054433, 9786254054594, 9786254054617, 9786254055416, 9786254055393,
  9786254055935, 9786254055966, 9786254056185, 9786254056208, 9786254056178, 9786254056680,
  9786254056666, 9786254057298, 9786254057571, 9786254058530, 9786254058271, 9786254058806,
  9786254058790, 9786254059346, 9786254059247, 9786254059223, 9786254059315, 9786254059773,
  9786254290169, 9786254291050, 9786254290473, 9786254291081, 9786254291562, 9786254291555,
  9786254291975, 9786254291845, 9786254292019, 9786254292293, 9786254292873, 9786254293061,
  9786254293351, 9786254293481, 9786254293528, 9786254293511, 9786254293832, 9786254294594,
  9786254294457, 9786254294785, 9786254295515, 9786254295294, 9786254296116, 9786254296093,
  9786254296185, 9786254296314, 9786254296307, 9786254296550, 9786254296956, 9786254296994,
  9786254296970, 9786254297410, 9786254297397, 9786254298059, 9786254298196, 9786254298189,
  9786254298585, 9786254298752, 9786254298943, 9786254298967, 9786254299292, 9786254299643,
  9786254299841, 9786254299940, 9786254299872,
];

// Kapak görselinin URL'sini döndüren fonksiyon
function getCoverUrl(isbn) {
  return `https://covers.openlibrary.org/b/id/${isbn}-L.jpg`;
}

// Kapak görselini indirip kaydeden fonksiyon
async function downloadCover(isbn) {
  const url = getCoverUrl(isbn);
  try {
    const response = await axios.get(url, { responseType: "arraybuffer" });
    const filePath = path.join(__dirname, "kitap_kapaklari", `${isbn}.jpg`);

    // Kapak görselini dosyaya yazıyoruz
    fs.writeFileSync(filePath, response.data);
    console.log(`ISBN ${isbn} için kapak indirildi ve ${filePath} olarak kaydedildi.`);
  } catch (error) {
    console.log(`ISBN ${isbn} için kapak görseli bulunamadı.`);
  }
}

// Kapakları kaydedeceğimiz klasörü oluşturuyoruz
if (!fs.existsSync("kitap_kapaklari")) {
  fs.mkdirSync("kitap_kapaklari");
}

// Her ISBN için kapakları indiriyoruz
isbnList.forEach((book) => {
  downloadCover(book.isbn);
});
